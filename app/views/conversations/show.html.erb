<div class="offnav"></div>
<div class="container top bottom">
  <h1 class='page-title center'>Conversation avec <%= @conversation.with(current_user).name %></h1>
  <div id="conversation-main">
    <div id="conversationBody">
      <%= render @conversation.personal_messages.sort_by(&:created_at).reverse %>
    </div>
    <%= simple_form_for @personal_message do |f| %>
      <%= hidden_field_tag 'conversation_id', @conversation.id %>
      <%= f.input :body, as: :string, required: false, label: false, class: 'inputMessage' %>
      <label class="photo">
        <i class="fas fa-camera-retro" id='loader'></i>
        <span style="display:none;">
          <%= f.input :photo, as: :file, required: false, multiple: true, name: 'picture' %>
        </span>
      </label>
      <p class='center'><%= f.button :submit, "Envoyer", class: 'btn btn-ghost bottom' %></p>
    <% end %>
  </div>
</div>

<script type="text/javascript">
  $(document).ready(function(){
    function updateDiv() {
      $( "#conversationBody" ).load(window.location.href + " #conversationBody" );
    }
    setInterval(updateDiv, 10000);
  });
</script>

