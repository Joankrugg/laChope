<div class="offnavs"></div>
<div class="container top">
  <div class="row">
    <div class="col-lg-1"></div>
    <div class="col-lg-4 card-show bottom">
      <% if @user.photo.present? %>
        <%= cl_image_tag @user.photo.key, height: 250, width: 250, crop: :fill, class: 'show-img avatar-large' %>
      <% else %>
        <%= cl_image_tag "https://res.cloudinary.com/da2krghvd/image/upload/v1598020963/19_C2_B0_International_Jazz_Festival_of_Punta_del_Este_-_150111-2052-jikatu__2816077813707_29_drogug.jpg", class: "img-fluid profil-picture", height: 250, width: 250, crop: :fill %>
      <% end %>
      <div class="show-infos">
        <% if @user.username.present? %>
          <p> <%= @user.username %></p>
        <% end %>
        <p><%=@user.email %></p>

        <% if @user.website.present? %>
          <%= link_to 'mon site', @user.website, target: :blank %></p>
        <% end %>

        <% if @user.activities.present? %>
          <p>activité(s)</p>
          <% @user.activities.each do |a| %>
            <p> <%= a.name %></p>
          <% end %>
        <% end %>
        <% if @user.design.present? %>
          <% if @user.design.alcohol_shape.present? %>
            <%= @user.design.alcohol_shape.name %>
          <% end %>
          <% if @user.design.design_color.present? %>
            <%= @user.design.design_color.name %>
          <% end %>
          <% if @user.design.main_taste.present? %>
            <%= @user.design.main_taste.name %>
          <% end %>
          <% if @user.design.flavours.present? %>
            <% @user.design.flavours.each do |f| %>
              <%= f.name %>
            <% end %>
          <% end %>
          <% if @user.design.feelings.present? %>
            <% @user.design.feelings.each do |f| %>
              <%= f.name %>
            <% end %>
          <% end %>
        <% end %>
        <p>réservation</p>

        <p>membre oui/non</p>
        <% if current_user.admin == true %>
          <%= link_to "Administration", rails_admin_path, class: "dropdown-item" %>
        <% end %>
      </div>
    </div>
    <div class="col-lg-1"></div>
    <div class="col-lg-6 card-show bottom">
      <!-- Nav tabs -->
      <ul class="nav nav-tabs">
        <li class="nav-item">
          <a class="nav-link active" data-toggle="tab" href="#profil">Profil</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" data-toggle="tab" href="#beers">Bières</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" data-toggle="tab" href="#ideal">Idéal</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" data-toggle="tab" href="#known">Connues</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" data-toggle="tab" href="#unknown">à goûter</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" data-toggle="tab" href="#tips">à goûter</a>
        </li>
      </ul>

      <!-- Tab panes -->
      <div class="tab-content">
        <div class="tab-pane active container" id="profil">
          <% if @user == current_user %>
            <%= render 'form' %>
          <% end %>
        </div>
        <div class="tab-pane container" id="beers">
          <% if @user == current_user %>
            <%= render 'beers/form', beer: @beer %>
          <% end %>
        </div>
        <div class="tab-pane container" id="ideal">
          <% if @user == current_user %>
            <%= render 'designs/form', design: @design %>
          <% end %>
        </div>
        <div class="tab-pane container" id="known">
          <% if @user.ratings.present?  %>
            <% @user.ratings.each do |b| %>
              <%= b.beer.name %>
              <%= b.stars %>
            <% end %>
          <% end %>

        </div>
        <div class="tab-pane container" id="unknown">
          <% very_strong_beers = [] %>
          <% strong_beers = [] %>
          <% regular_beers = [] %>
          <% light_beers = [] %>
          <% alcohol_free_beers = [] %>
          <% blanche = [] %>
          <% yellow = [] %>
          <% blonde = [] %>
          <% golden = [] %>
          <% ambre = [] %>
          <% rousse = [] %>
          <% brune = [] %>
          <% ruby = [] %>
          <% coffee = [] %>
          <% black = [] %>
          <% b = @beers %>
          <% b.each do |beer| %>
            <% if beer.alcohol_level > 9 %>
              <% very_strong_beers << beer %>
            <% elsif 6 < beer.alcohol_level &&  beer.alcohol_level <= 9  == true %>
              <% strong_beers << beer %>
            <% elsif 4 < beer.alcohol_level &&  beer.alcohol_level <= 6  == true %>
              <% regular_beers << beer %>
            <% elsif 1 < beer.alcohol_level &&  beer.alcohol_level <= 4  == true %>
              <% light_beers << beer %>
            <% else %>
              <% alcohol_free_beers << beer %>
            <% end %>
          <% end %>
          <% b.each do |beer| %>
            <% if beer.color > 70 %>
              <% black << beer %>
            <% elsif 57 < beer.color &&  beer.color <= 70  == true %>
              <% coffee << beer %>
            <% elsif 39 < beer.color &&  beer.color <= 57  == true %>
              <% brune << beer %>
            <% elsif 38 < beer.color &&  beer.color <= 42  == true %>
              <% ruby << beer %>
            <% elsif 30 < beer.color &&  beer.color <= 36  == true %>
              <% rousse << beer %>
            <% elsif 26 < beer.color &&  beer.color <= 33  == true %>
              <% ambre << beer %>
            <% elsif 16 < beer.color &&  beer.color <= 26  == true %>
              <% golden << beer %>
            <% elsif 6 < beer.color &&  beer.color <= 20  == true %>
              <% blonde << beer %>
            <% elsif 4 < beer.color &&  beer.color <= 8 == true %>
              <% yellow << beer %>
            <% elsif 4 < beer.color &&  beer.color <= 6 == true %>
              <% blanche << beer %>
            <% else %>
              <% alcohol_free_beers << beer %>
            <% end %>
          <% end %>
          <% very_strong_beers.each do |vsb| %>
            <p>VSB</p>
            <%= vsb.name %>
          <% end %>
          <p>à goûter absolument</p>
          <% strong_beers.each do |sb| %>
            <p>SB</p>
            <%= sb.name %>
          <% end %>
          <p>à goûter très certainement</p>
          <p>à goûter probablement</p>
          <p>à découvrir sait-on jamais</p>
        </div>
      </div>
    </div>
  </div>
</div>

<% if @user.beers.present? %>
  <div class="container top ">
    <div class="row">
      <div class="col-lg-1"></div>
      <h3>Vos bières</h3>
    </div>
  </div>
  <% @user.beers.each do |b| %>
    <%= link_to b do %>
      <div class="container top bottom">
        <div class="row">
          <div class="col-lg-1"></div>
          <div class="col-lg-11 card-product">
            <%= cl_image_tag b.photo.key, height: 100, width: 80, crop: :fit %>
            <div class="card-product-infos">
              <%= b.name %>
              <%= b.style.name %>
              <%= b.alcohol_level %>
              <%= b.color %>
              <%= b.bitterness %>
              <%= b.description %>
            </div>
          </div>
        </div>
      </div>
    <% end %>
  <% end %>
<% end %>


